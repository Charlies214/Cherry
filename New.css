/* CSS变量定义 */
.TagsContainer-erHQJu:nth-child(1) { --group-color: 59, 130, 246; }
.TagsContainer-erHQJu:nth-child(2) { --group-color: 34, 197, 94; }
.TagsContainer-erHQJu:nth-child(3) { --group-color: 168, 85, 247; }
.TagsContainer-erHQJu:nth-child(4) { --group-color: 249, 115, 22; }
.TagsContainer-erHQJu:nth-child(5) { --group-color: 239, 68, 68; }
.TagsContainer-erHQJu:nth-child(6) { --group-color: 6, 182, 212; }
.TagsContainer-erHQJu:nth-child(7) { --group-color: 245, 158, 11; }
.TagsContainer-erHQJu:nth-child(8) { --group-color: 156, 163, 175; }
.TagsContainer-erHQJu:nth-child(9) { --group-color: 219, 39, 119; }
.TagsContainer-erHQJu:nth-child(10) { --group-color: 99, 102, 241; }

/* 分组容器基础样式 */
.TagsContainer-erHQJu {
    margin: 12px 8px;
    padding: 12px 8px;
    border-radius: 12px;
    background: rgba(var(--group-color, 156, 163, 175), 0.06);
    border: 1px solid rgba(var(--group-color, 156, 163, 175), 0.12);
    overflow: hidden;
}

.TagsContainer-erHQJu:has(.GroupTitle-bZsCjw) {
    padding: 0;
}

/* 分组标题 */
.GroupTitle-bZsCjw {
    margin: 0;
    padding: 14px 16px;
    background: rgba(var(--group-color, 156, 163, 175), 0.12);
    border: none;
    border-radius: 12px 12px 0 0;
    border-bottom: 1px solid rgba(var(--group-color, 156, 163, 175), 0.08);
    cursor: pointer;
    transition: all 0.2s ease;
}

.GroupTitle-bZsCjw:hover {
    background: rgba(var(--group-color, 156, 163, 175), 0.16);
}

.GroupTitleName-ifOZPj {
    font-weight: 600;
    font-size: 14px;
    color: rgba(var(--group-color, 156, 163, 175), 0.9);
    display: flex;
    align-items: center;
    margin: 0;
    letter-spacing: 0.025em;
}

.GroupTitleName-ifOZPj .anticon {
    margin-right: 8px;
    color: rgba(var(--group-color, 156, 163, 175), 0.7);
    font-size: 12px;
    transition: all 0.2s ease;
}

.GroupTitleDivider-hDobAZ {
    display: none;
}

.TagsContainer-erHQJu:has(.GroupTitle-bZsCjw) > div:not(.GroupTitle-bZsCjw) {
    padding: 0 12px;
}

.TagsContainer-erHQJu:has(.GroupTitle-bZsCjw) .Container-lnWGMS:last-of-type,
.TagsContainer-erHQJu:has(.GroupTitle-bZsCjw) .AssistantAddItem-cnwcTr {
    margin-bottom: 12px;
}

/* 助手容器 */
.Container-cFFyqi {
    display: flex;
    align-items: center;
    width: 100%;
    border-radius: 8px;
    transition: all 0.25s ease;
    margin: 2px 0;
    background: transparent;
}

.AssistantNameRow-eRVxCS {
    padding: 10px 12px;
    background: transparent !important;
    border: none;
    display: flex;
    align-items: center;
    flex: 1;
    min-width: 0;
    border-radius: inherit;
    transition: all 0.25s ease;
}

.Container-gOOWxz {
    display: flex;
    align-items: center;
    flex-shrink: 0;
}

.AssistantName-cHMAyM {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: #e5e7eb;
    font-size: 13px;
    font-weight: 400;
    transition: all 0.25s ease;
    flex: 1;
    min-width: 0;
    margin-left: 8px;
}

/* 修复双重圆形的关键：去除MenuButton背景 */
.MenuButton-kywHgl {
    display: flex;
    align-items: center;
    flex-shrink: 0;
    margin-left: 8px;
    background: none !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important;
}

.TopicCount-IXqyx {
    background: rgba(255, 255, 255, 0.08);
    color: #9ca3af;
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 10px;
    padding: 2px 6px;
    font-size: 11px;
    font-weight: 500;
    min-width: 16px;
    text-align: center;
    line-height: 1.2;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: all 0.25s ease;
    box-shadow: none;
}

/* hover状态 */
.Container-cFFyqi:hover {
    background: rgba(var(--group-color, 156, 163, 175), 0.08) !important;
}

.Container-cFFyqi:hover .TopicCount-IXqyx {
    background: rgba(var(--group-color, 156, 163, 175), 0.12);
    border-color: rgba(var(--group-color, 156, 163, 175), 0.2);
    color: rgba(var(--group-color, 156, 163, 175), 0.85);
    transform: scale(1.02);
}

/* 激活状态 */
.Container-cFFyqi.active {
    background: rgba(var(--group-color, 156, 163, 175), 0.1) !important;
    border: 1px solid rgba(var(--group-color, 156, 163, 175), 0.2);
    box-shadow: 0 1px 2px rgba(var(--group-color, 156, 163, 175), 0.08);
}

.Container-cFFyqi.active .AssistantNameRow-eRVxCS {
    font-weight: 500;
}

.Container-cFFyqi.active .AssistantName-cHMAyM {
    color: rgba(var(--group-color, 156, 163, 175), 0.95) !important;
    font-weight: 500;
}

.Container-cFFyqi.active .TopicCount-IXqyx {
    background: rgba(var(--group-color, 156, 163, 175), 0.9);
    color: #ffffff !important;
    border-color: rgba(var(--group-color, 156, 163, 175), 0.9);
    font-weight: 600;
    transform: scale(1.02);
}

.Container-cFFyqi.active:hover {
    background: rgba(var(--group-color, 156, 163, 175), 0.14) !important;
    box-shadow: 0 2px 3px rgba(var(--group-color, 156, 163, 175), 0.12);
    transform: translateX(1px);
}

.Container-cFFyqi.active:hover .TopicCount-IXqyx {
    background: rgba(var(--group-color, 156, 163, 175), 1);
    color: #ffffff !important;
    border-color: rgba(var(--group-color, 156, 163, 175), 1);
    transform: scale(1.05);
}

/* 浅色模式 */
@media (prefers-color-scheme: light) {
    .AssistantName-cHMAyM {
        color: #374151;
    }
    
    .GroupTitleName-ifOZPj {
        color: rgba(var(--group-color, 156, 163, 175), 0.85);
    }
    
    .GroupTitleName-ifOZPj .anticon {
        color: rgba(var(--group-color, 156, 163, 175), 0.65);
    }
    
    .Container-cFFyqi.active .AssistantName-cHMAyM {
        color: rgba(var(--group-color, 156, 163, 175), 0.9) !important;
    }
    
    .Container-cFFyqi:hover {
        background: rgba(var(--group-color, 156, 163, 175), 0.06) !important;
    }
    
    .Container-cFFyqi.active {
        background: rgba(var(--group-color, 156, 163, 175), 0.08) !important;
        border-color: rgba(var(--group-color, 156, 163, 175), 0.25);
        box-shadow: 0 1px 2px rgba(var(--group-color, 156, 163, 175), 0.06);
    }
    
    .Container-cFFyqi.active:hover {
        background: rgba(var(--group-color, 156, 163, 175), 0.12) !important;
        box-shadow: 0 2px 3px rgba(var(--group-color, 156, 163, 175), 0.1);
    }
    
    .TopicCount-IXqyx {
        background: rgba(0, 0, 0, 0.05);
        color: #6b7280;
        border-color: rgba(0, 0, 0, 0.08);
    }
    
    .Container-cFFyqi:hover .TopicCount-IXqyx {
        background: rgba(var(--group-color, 156, 163, 175), 0.1);
        color: rgba(var(--group-color, 156, 163, 175), 0.8);
        border-color: rgba(var(--group-color, 156, 163, 175), 0.15);
    }
}

/* 深色模式 */
@media (prefers-color-scheme: dark) {
    .TagsContainer-erHQJu {
        background: rgba(var(--group-color, 156, 163, 175), 0.08);
        border-color: rgba(var(--group-color, 156, 163, 175), 0.15);
    }
    
    .GroupTitle-bZsCjw {
        background: rgba(var(--group-color, 156, 163, 175), 0.15);
        border-bottom-color: rgba(var(--group-color, 156, 163, 175), 0.1);
    }
    
    .GroupTitle-bZsCjw:hover {
        background: rgba(var(--group-color, 156, 163, 175), 0.2);
    }
    
    .GroupTitleName-ifOZPj {
        color: rgba(var(--group-color, 156, 163, 175), 0.95);
    }
    
    .GroupTitleName-ifOZPj .anticon {
        color: rgba(var(--group-color, 156, 163, 175), 0.8);
    }
    
    .Container-cFFyqi:hover {
        background: rgba(var(--group-color, 156, 163, 175), 0.1) !important;
    }
    
    .Container-cFFyqi.active {
        background: rgba(var(--group-color, 156, 163, 175), 0.12) !important;
        border-color: rgba(var(--group-color, 156, 163, 175), 0.3);
        box-shadow: 0 1px 2px rgba(var(--group-color, 156, 163, 175), 0.1);
    }
    
    .Container-cFFyqi.active:hover {
        background: rgba(var(--group-color, 156, 163, 175), 0.16) !important;
        box-shadow: 0 2px 3px rgba(var(--group-color, 156, 163, 175), 0.15);
    }
}

/* 表情符号背景 */
.EmojiBackground-fPdsEN {
    border-radius: 6px;
    margin-right: 8px;
    flex-shrink: 0;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.25s ease;
}

/* 添加助手按钮 */
.AssistantAddItem-cnwcTr {
    margin: 8px 0 0 0;
    padding: 12px;
    border: 2px dashed rgba(var(--group-color, 156, 163, 175), 0.3);
    border-radius: 8px;
    background: rgba(var(--group-color, 156, 163, 175), 0.02);
    transition: all 0.25s ease;
    cursor: pointer;
    width: 100%;
}

.AssistantAddItem-cnwcTr:hover {
    border-color: rgba(var(--group-color, 156, 163, 175), 0.5);
    background: rgba(var(--group-color, 156, 163, 175), 0.08);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(var(--group-color, 156, 163, 175), 0.15);
}

.AssistantAddItem-cnwcTr .AssistantName-hllWJP {
    color: rgba(var(--group-color, 156, 163, 175), 0.8);
    font-size: 13px;
    display: flex;
    align-items: center;
    font-weight: 500;
}

.AssistantAddItem-cnwcTr .anticon-plus {
    margin-right: 8px;
    font-size: 12px;
    color: rgba(var(--group-color, 156, 163, 175), 0.9);
}

@media (prefers-color-scheme: dark) {
    .AssistantAddItem-cnwcTr {
        border-color: rgba(var(--group-color, 156, 163, 175), 0.25);
        background: rgba(var(--group-color, 156, 163, 175), 0.03);
    }
    
    .AssistantAddItem-cnwcTr:hover {
        border-color: rgba(var(--group-color, 156, 163, 175), 0.4);
        background: rgba(var(--group-color, 156, 163, 175), 0.1);
    }
    
    .AssistantAddItem-cnwcTr .AssistantName-hllWJP {
        color: rgba(var(--group-color, 156, 163, 175), 0.9);
    }
    
    .AssistantAddItem-cnwcTr .anticon-plus {
        color: rgba(var(--group-color, 156, 163, 175), 0.95);
    }
}



/**
 * Cherry Studio - Apple Design Overhaul
 * Crafted by Swift Expert
 *
 * This version addresses the stubborn sidebar glass effect by targeting the root cause:
 * an opaque layout container blocking the backdrop. By making the main layout
 * transparent, the sidebar's backdrop-filter can now function as intended.
 *
 * - Strategy: "Unblock" the view instead of faking the effect.
 * - Key Fix: Set the background of the main `.ant-layout` to transparent.
 * - Result: A true, functional, and elegant glassmorphism sidebar.
 */
/* ---  Light Mode --- */
body[theme-mode="light"] {
  --bg-page-light: #F5F5F7; /* macOS Light Mode Background */
  --color-accent-light: #FF3B30; /* macOS Accent Red (Light) - MODIFIED */
  --bg-material-light: rgba(252, 252, 252, 0.8);
  --border-material-light: rgba(0, 0, 0, 0.12);
  --shadow-material-light: 0 16px 32px rgba(0, 0, 0, 0.08), 0 6px 12px rgba(0, 0, 0, 0.06);
  --text-primary-light: rgba(0, 0, 0, 0.88);
  --text-secondary-light: rgba(60, 60, 67, 0.68);
}


/* ---  Base & Typography with Ambient BG --- */
body {
  font-family: var(--font-apple-system) !important;
  font-weight: 400;
  letter-spacing: normal !important;
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background var(--transition-normal);
}
body[theme-mode="dark"] { background: radial-gradient(circle at 50% 0%, hsl(240, 3%, 15%), var(--bg-page-dark) 70%); }
body[theme-mode="light"] { background: radial-gradient(circle at 50% 0%, hsl(240, 5%, 98%), var(--bg-page-light) 80%); }

/* --- THE KEY FIX --- */
/* Make the main layout container transparent to allow backdrop-filter to work */
.ant-layout, .ant-layout-has-sider, #root > .ant-layout {
  background: transparent !important;
}


h1, h2, h3, h4, h5, h6 { font-family: var(--font-apple-system) !important; font-weight: 600 !important; color: var(--text-primary-dark); }
body[theme-mode="light"] h1, body[theme-mode="light"] h2, body[theme-mode="light"] h3, body[theme-mode="light"] h4, body[theme-mode="light"] h5, body[theme-mode="light"] h6 { color: var(--text-primary-light); }
.markdown p, .markdown li, .markdown blockquote, .markdown table { font-family: var(--font-apple-system) !important; font-weight: 400; color: var(--text-secondary-dark); }
body[theme-mode="light"] .markdown p, body[theme-mode="light"] .markdown li, body[theme-mode="light"] .markdown blockquote, body[theme-mode="light"] .markdown table { color: var(--text-secondary-light); }
code, pre, .cherry-code-content, .cherry-code-content * { font-family: var(--font-apple-mono) !important; font-size: 0.95em !important; line-height: 1.6 !important; }
strong, b { color: var(--color-accent-dark) !important; }
body[theme-mode="light"] strong, b { color: var(--color-accent-light) !important; }


/* ---  Applying Material Style to Components --- */
.inputbar-container,
.ant-popover-inner,
.ant-notification-notice,
.ant-message-notice-content,
.ant-drawer-content,
.ant-modal-content,
.cherry-code-wrapper,
.bubble .message-content-container {
  background-color: var(--bg-material-dark) !important;
  backdrop-filter: blur(30px) saturate(1.8);
  -webkit-backdrop-filter: blur(30px) saturate(1.8);
  border-radius: var(--radius-l) !important;
  border: 1px solid var(--border-material-dark) !important;
  box-shadow: var(--shadow-material-dark) !important;
  color: var(--text-primary-dark) !important;
  transition: var(--transition-normal);
  overflow: hidden;
}
body[theme-mode="light"] .inputbar-container,
body[theme-mode="light"] .ant-popover-inner,
body[theme-mode="light"] .ant-notification-notice,
body[theme-mode="light"] .ant-message-notice-content,
body[theme-mode="light"] .ant-drawer-content,
body[theme-mode="light"] .ant-modal-content,
body[theme-mode="light"] .cherry-code-wrapper,
body[theme-mode="light"] .bubble .message-content-container {
  background-color: var(--bg-material-light) !important;
  border: 1px solid var(--border-material-light) !important;
  box-shadow: var(--shadow-material-light) !important;
  color: var(--text-primary-light) !important;
}

/* ---  Sidebar --- */
div[class*="AgentsGroupList-"] {
  background-color: var(--bg-material-dark) !important;
  backdrop-filter: blur(30px) saturate(1.8);
  -webkit-backdrop-filter: blur(30px) saturate(1.8);
  border-right: 1px solid var(--border-material-dark) !important;
  padding: 8px !important;
  min-width: 160px !important; height: 100vh !important; display: flex !important; flex-direction: column !important; gap: 4px !important; overflow-y: auto !important;
}
body[theme-mode="light"] div[class*="AgentsGroupList-"] {
  background-color: var(--bg-material-light) !important;
  border-right-color: var(--border-material-light) !important;
}
div[class*="AgentsGroupList-"]::-webkit-scrollbar { display: none !important; }

/* --- Chat Bubble & Input --- */
.bubble .message-content-container { padding: 14px 20px !important; }
.inputbar-container { padding: 8px !important; }
/* This part also needs a color change for the focus outline */
.inputbar-container:focus-within {
  border-color: rgba(255, 69, 58, 0.7) !important; /* Red version of the blue outline */
  box-shadow: var(--shadow-material-dark), 0 0 0 4px rgba(255, 69, 58, 0.3) !important; /* Red version of the blue shadow */
  transform: translateY(-2px);
}
body[theme-mode="light"] .inputbar-container:focus-within {
  border-color: rgba(255, 59, 48, 0.7) !important; /* Red version of the blue outline */
  box-shadow: var(--shadow-material-light), 0 0 0 4px rgba(255, 59, 48, 0.2) !important; /* Red version of the blue shadow */
}
.inputbar-container textarea { color: var(--text-primary-dark) !important; }
body[theme-mode="light"] .inputbar-container textarea { color: var(--text-primary-light) !important; }

/* ---  Code Blocks (Centered Title) --- */
.cherry-code-wrapper { margin: 1.5em 0; }
.markdown pre [class^="CodeHeader-"] { position: relative; display: block; text-align: center; line-height: 42px; height: 42px; padding: 0 80px !important; background-color: rgba(0, 0, 0, 0.25) !important; border-bottom: 1px solid var(--border-material-dark) !important; color: var(--text-secondary-dark); }
body[theme-mode="light"] .markdown pre [class^="CodeHeader-"] { background-color: rgba(255, 255, 255, 0.3) !important; border-bottom: 1px solid var(--border-material-light) !important; color: var(--text-secondary-light); }
.markdown pre [class^="CodeHeader-"]::before { content: ' '; position: absolute; left: 16px; top: 50%; transform: translateY(-50%); width: 12px; height: 12px; border-radius: 50%; background: #FF5F56; box-shadow: 20px 0 #FFBD2E, 40px 0 #27C93F; }
.markdown pre [class^="CodeContent-"] { padding: 16px !important; margin: 0 !important; }


/* --- Lists & Menu Items --- */
.cherry-menu-item, .cherry-list-item { border-radius: var(--radius-m) !important; color: var(--text-secondary-dark); transition: var(--transition-fast); border: none !important; background: transparent !important; margin: 2px 4px !important; padding: 8px 12px !important; }
body[theme-mode="light"] .cherry-menu-item, body[theme-mode="light"] .cherry-list-item { color: var(--text-secondary-light); }
.cherry-menu-item:hover, .cherry-list-item:hover { background: rgba(255, 255, 255, 0.1) !important; color: var(--text-primary-dark) !important; }
body[theme-mode="light"] .cherry-menu-item:hover, body[theme-mode="light"] .cherry-list-item:hover { background: rgba(0, 0, 0, 0.08) !important; color: var(--text-primary-light) !important; }
.cherry-menu-item.active, .cherry-list-item.active { background: var(--color-accent-dark) !important; color: #fff !important; font-weight: 500; }
body[theme-mode="light"] .cherry-menu-item.active, body[theme-mode="light"] .cherry-list-item.active { background: var(--color-accent-light) !important; color: #fff !important; }


/* --- Buttons & Controls --- */
.ant-btn { border-radius: var(--radius-m) !important; border: none !important; background-color: rgba(255, 255, 255, 0.12) !important; color: var(--text-primary-dark) !important; transition: var(--transition-fast); }
.ant-btn:hover { background-color: rgba(255, 255, 255, 0.2) !important; transform: scale(1.03); }
body[theme-mode="light"] .ant-btn { background-color: rgba(0, 0, 0, 0.08) !important; color: var(--text-primary-light) !important; }
body[theme-mode="light"] .ant-btn:hover { background-color: rgba(0, 0, 0, 0.12) !important; }


/* --- Selection --- */
/* This part also needs a color change */
::selection { background-color: rgba(255, 69, 58, 0.4); color: var(--text-primary-dark); }
body[theme-mode="light"] ::selection { color: var(--text-primary-light); }

/* --- Cleanup & Reset --- */
.cherry-3d-enhanced::before, .cherry-3d-enhanced::after, [class*="ListItemContent-"]::before, [class*="ListItemContent-"]::after, [class*="TitleText-"]::before, [class*="TitleText-"]::after,
.markdown pre [class^="CodeHeader-"] .iconfont.icon-copy.copy {
  display: none !important;
}
